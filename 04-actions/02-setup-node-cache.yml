# ============================================================
# D√âMO 2/4 ‚Äî Actions : setup-node + cache npm
# ============================================================
# "actions/setup-node" installe et configure Node.js.
# L'option "cache: 'npm'" met node_modules en cache
# pour acc√©l√©rer les prochains runs (√©vite de tout
# ret√©l√©charger √† chaque fois).
#
# Avec "with:", on passe des param√®tres √† l'action,
# comme des arguments de fonction.
# ============================================================

name: "14 ¬∑ Action setup-node + cache"

on: workflow_dispatch

jobs:
  demo-node:
    name: "setup-node avec cache npm"
    runs-on: ubuntu-latest

    steps:
      - name: "üì• Checkout"
        uses: actions/checkout@v4

      - name: "‚öôÔ∏è Configurer Node.js 20 avec cache npm"
        uses: actions/setup-node@v4
        with:
          node-version: "20"        # version de Node.js √† installer
          cache: "npm"              # met ~/.npm en cache entre les runs

      - name: "üîç V√©rifier la version install√©e"
        run: |
          echo "Node  : $(node --version)"
          echo "npm   : $(npm --version)"
          echo "npx   : $(npx --version)"

      - name: "üì¶ Installer les d√©pendances (si package.json existe)"
        run: |
          if [ -f package.json ]; then
            npm ci
            echo "‚úÖ D√©pendances install√©es"
          else
            echo "‚ÑπÔ∏è Pas de package.json dans ce d√©p√¥t"
          fi
