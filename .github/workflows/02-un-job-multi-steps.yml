# ============================================================
# DÃ‰MO 2/4 â€” Jobs & Steps : un job, plusieurs steps
# ============================================================
# Un seul job avec PLUSIEURS steps.
# Les steps s'exÃ©cutent DANS L'ORDRE, un par un.
# Si un step Ã©choue â†’ les suivants sont annulÃ©s.
# ============================================================

name: "07 Â· Un job, plusieurs steps"

on: workflow_dispatch

jobs:
  pipeline:
    name: "Pipeline sÃ©quentiel"
    runs-on: ubuntu-latest

    steps:
      # Step 1 â€” Toujours en premier pour Node.js
      - name: "ğŸ“¥ Step 1 â€” VÃ©rifier l'environnement"
        run: |
          echo "=== Environnement de la machine ==="
          echo "OS     : $(uname -s) $(uname -r)"
          echo "User   : $(whoami)"
          echo "Dossier: $(pwd)"

      - name: "ğŸ“¦ Step 2 â€” Lister les outils disponibles"
        run: |
          echo "=== Versions des outils prÃ©-installÃ©s ==="
          node --version
          npm --version
          python3 --version
          java --version
          dotnet --version

      - name: "ğŸ“ Step 3 â€” CrÃ©er un fichier"
        run: |
          echo "CrÃ©Ã© par GitHub Actions le $(date)" > rapport.txt
          echo "Run : ${{ github.run_number }}"      >> rapport.txt
          cat rapport.txt

      - name: "ğŸ” Step 4 â€” VÃ©rifier que le fichier existe"
        run: |
          if [ -f rapport.txt ]; then
            echo "âœ… rapport.txt trouvÃ© ($(wc -c < rapport.txt) octets)"
          else
            echo "âŒ rapport.txt introuvable !"
            exit 1
          fi
