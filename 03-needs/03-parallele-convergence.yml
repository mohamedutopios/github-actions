# ============================================================
# DÃ‰MO 3/3 â€” needs : parallÃ¨le puis convergence
# ============================================================
# Pattern avancÃ© : deux jobs tournent EN PARALLÃˆLE,
# et un troisiÃ¨me attend que LES DEUX soient terminÃ©s.
#
#   tests-unitaires â”€â”
#                    â”œâ”€â”€â†’ deploiement
#   verif-style     â”€â”˜
#
# needs accepte une liste : needs: [job-a, job-b]
# Le job attend que TOUS soient rÃ©ussis.
# ============================================================

name: "12 Â· needs â€” parallÃ¨le + convergence"

on: workflow_dispatch

jobs:

  # â”€â”€â”€ JOB A â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  tests-unitaires:
    name: "ğŸ§ª Tests unitaires"
    runs-on: ubuntu-latest
    steps:
      - name: Tests unitaires (3s)
        run: |
          sleep 3
          echo "âœ… Tests unitaires : OK"

  # â”€â”€â”€ JOB B (en parallÃ¨le avec A) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  verif-style:
    name: "ğŸ¨ Lint & style"
    runs-on: ubuntu-latest
    steps:
      - name: VÃ©rification du style (1s)
        run: |
          sleep 1
          echo "âœ… Lint : OK"

  # â”€â”€â”€ JOB C (attend A ET B) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  deploiement:
    name: "ğŸš€ DÃ©ploiement"
    runs-on: ubuntu-latest
    needs: [tests-unitaires, verif-style]  # â† attend les DEUX
    steps:
      - name: DÃ©ployer seulement si tout est vert
        run: |
          echo "âœ… Tests OK + Style OK â†’ dÃ©ploiement autorisÃ©"
          echo "ğŸš€ DÃ©ploiement en cours..."
