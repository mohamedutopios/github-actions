# ============================================================
# DÃ‰MO 1/3 â€” needs : deux jobs sÃ©quentiels
# ============================================================
# Avec "needs:", le job "deploiement" attend que le job
# "tests" soit terminÃ© avec SUCCÃˆS avant de dÃ©marrer.
#
# Si "tests" Ã©choue â†’ "deploiement" est annulÃ©.
# C'est la garde-fou fondamentale : jamais dÃ©ployer
# sans que les tests soient passÃ©s.
# ============================================================

name: "10 Â· needs â€” sÃ©quentiel simple"

on: workflow_dispatch

jobs:

  # â”€â”€â”€ JOB 1 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  tests:
    name: "ğŸ§ª 1 Â· Tests"
    runs-on: ubuntu-latest
    steps:
      - name: Lancer les tests
        run: |
          echo "Tests en cours..."
          sleep 2
          echo "âœ… Tous les tests passent"

  # â”€â”€â”€ JOB 2 (attend JOB 1) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  deploiement:
    name: "ğŸš€ 2 Â· DÃ©ploiement"
    runs-on: ubuntu-latest
    needs: tests                   # â† attend que "tests" rÃ©ussisse
    steps:
      - name: DÃ©ployer l'application
        run: |
          echo "Tests OK âœ…, dÃ©ploiement en cours..."
          sleep 1
          echo "ğŸš€ Application dÃ©ployÃ©e avec succÃ¨s !"
