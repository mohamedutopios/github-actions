# ============================================================
# DÃ‰MO 1/4 â€” Variables : env: global vs local
# ============================================================
# Les variables d'environnement se dÃ©finissent avec "env:"
# Ã  trois niveaux diffÃ©rents (portÃ©e croissante) :
#
#   Au niveau du workflow  â†’ disponible dans TOUS les jobs
#   Au niveau du job       â†’ disponible dans ce job seulement
#   Au niveau du step      â†’ disponible dans ce step seulement
#
# AccÃ¨s dans un script shell : $NOM_VARIABLE
# ============================================================

name: "17 Â· Variables env â€” portÃ©e globale vs locale"

on: workflow_dispatch

# â”€â”€ Niveau 1 : Variables GLOBALES (tout le workflow) â”€â”€â”€â”€â”€â”€â”€â”€
env:
  APP_NAME: "mon-application"
  VERSION: "2.1.0"
  ENVIRONNEMENT: "staging"

jobs:
  demo-portees:
    name: "PortÃ©es des variables"
    runs-on: ubuntu-latest

    # â”€â”€ Niveau 2 : Variables du JOB (ce job seulement) â”€â”€â”€â”€â”€
    env:
      NOM_JOB: "demo-portees"
      RUNNER_INFO: "ubuntu-latest"

    steps:
      - name: "ğŸŒ Afficher les variables globales"
        run: |
          echo "=== Variables globales ==="
          echo "APP_NAME     : $APP_NAME"
          echo "VERSION      : $VERSION"
          echo "ENVIRONNEMENT: $ENVIRONNEMENT"

      - name: "ğŸ”§ Afficher les variables du job"
        run: |
          echo "=== Variables du job ==="
          echo "NOM_JOB    : $NOM_JOB"
          echo "RUNNER_INFO: $RUNNER_INFO"
          echo "(+ les globales sont aussi accessibles)"
          echo "APP_NAME   : $APP_NAME"

      - name: "ğŸ“Œ Variable locale Ã  ce step uniquement"
        # â”€â”€ Niveau 3 : Variable du STEP â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        env:
          STEP_MESSAGE: "Je suis visible uniquement dans ce step"
        run: |
          echo "=== Variable locale au step ==="
          echo "STEP_MESSAGE : $STEP_MESSAGE"

      - name: "âŒ STEP_MESSAGE n'est plus disponible ici"
        run: |
          echo "STEP_MESSAGE : '${STEP_MESSAGE}'"
          echo "(vide â€” elle n'existe plus dans ce step)"
