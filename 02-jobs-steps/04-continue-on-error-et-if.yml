# ============================================================
# DÃ‰MO 4/4 â€” Jobs & Steps : continue-on-error et if:
# ============================================================
# Deux options utiles pour contrÃ´ler le comportement
# en cas d'Ã©chec d'un step :
#
#   continue-on-error: true
#     â†’ le step peut Ã©chouer sans bloquer le job
#
#   if: failure()
#     â†’ n'exÃ©cute ce step QUE si un prÃ©cÃ©dent a Ã©chouÃ©
#
#   if: always()
#     â†’ exÃ©cute ce step quoi qu'il arrive (mÃªme en erreur)
# ============================================================

name: "09 Â· continue-on-error et conditions if:"

on: workflow_dispatch

jobs:
  demo-conditions:
    name: "Gestion des erreurs et conditions"
    runs-on: ubuntu-latest

    steps:
      - name: " Step 1 â€” RÃ©ussite normale"
        run: echo "Ce step rÃ©ussit normalement"

      - name: " Step 2 â€” Ã‰chec autorisÃ© (non bloquant)"
        run: |
          echo "Ce step va Ã©chouer, mais le job continue..."
          exit 1
        continue-on-error: true    # â† ne bloque pas le job

      - name: "âœ… Step 3 â€” ExÃ©cutÃ© quand mÃªme"
        run: echo "Je tourne malgrÃ© l'Ã©chec du step 2"

      - name: "ğŸš¨ Step 4 â€” Alerte en cas d'erreur rÃ©elle"
        if: failure()             # â† ne tourne QUE si un step a vraiment Ã©chouÃ©
        run: echo "ğŸš¨ Quelque chose a Ã©chouÃ© ! Envoyer une alerte..."

      - name: "ğŸ§¹ Step 5 â€” Nettoyage toujours exÃ©cutÃ©"
        if: always()              # â† tourne toujours, succÃ¨s OU Ã©chec
        run: echo "ğŸ§¹ Nettoyage effectuÃ© (toujours exÃ©cutÃ©)"
