# ============================================================
# D√âMO 1/3 ‚Äî Secrets : utilisation de base
# ============================================================
# Un secret = une variable chiffr√©e, jamais visible dans
# les logs ni dans le code.
#
# Avant de tester ce workflow, cr√©ez un secret :
#   GitHub ‚Üí votre d√©p√¥t ‚Üí Settings
#   ‚Üí Secrets and variables ‚Üí Actions
#   ‚Üí New repository secret
#   Nom   : MON_TOKEN
#   Valeur: une-valeur-de-test-quelconque
#
# Syntaxe : ${{ secrets.NOM_DU_SECRET }}
# ============================================================

name: "21 ¬∑ Secrets ‚Äî utilisation basique"

on: workflow_dispatch

jobs:
  demo-secret:
    name: "Utiliser un secret"
    runs-on: ubuntu-latest

    steps:
      - name: "üîê Injecter le secret via env:"
        # ‚úÖ BONNE PRATIQUE : injecter le secret dans env:
        # et l'utiliser comme variable shell ensuite.
        # Ne jamais mettre ${{ secrets.X }} directement dans run:
        env:
          MON_TOKEN: ${{ secrets.MON_TOKEN }}
        run: |
          echo "Le secret est inject√© en variable d'environnement"
          echo "Longueur du token : ${#MON_TOKEN} caract√®res"
          echo "Premiers caract√®res : ${MON_TOKEN:0:3}***"

      - name: "üëÅÔ∏è GitHub masque automatiquement les secrets"
        env:
          MON_TOKEN: ${{ secrets.MON_TOKEN }}
        run: |
          echo "M√™me si on affiche la valeur, GitHub la masque :"
          echo "Valeur : $MON_TOKEN"
          # Dans les logs GitHub, la valeur appara√Æt comme : ***

      - name: "‚ÑπÔ∏è GITHUB_TOKEN ‚Äî secret automatique"
        # GITHUB_TOKEN existe toujours, sans configuration
        run: |
          echo "GITHUB_TOKEN est automatiquement disponible"
          echo "Il permet d'interagir avec l'API GitHub"
          echo "Longueur : ${#GITHUB_TOKEN} caract√®res"
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
